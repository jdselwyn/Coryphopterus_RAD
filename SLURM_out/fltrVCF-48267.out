

fltrVCF.bash v4.4 -- a script to filter vcf files repeatably

Dependencies required for fltrVCF to be fully functional:
	R
		tidyverse
		gridExtra
	vcftools
	vcflib
	samtools
	perl
	mawk
	parallel
	rad_haplotyper.pl https://github.com/cbirdlab/rad_haplotyper.git
	filter_hwe_by_pop_HPC

Wed Sep 22 16:05:53 CDT 2021 Reading options from command line:

	Settings File:            /work/hobi/jselwyn/Coryphopterus_RAD/config_files/fltrVCF_A.config

	Cutoffs:                  10.1
	Path to BAM files:        /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test
	PopMap File:              /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/mapped.10.1.bed
	VCF File:                 /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/TotalRawSNPs.10.1.vcf
	REF File:                 /work/hobi/jselwyn/Coryphopterus_RAD/mkREF_MiSeq/reference.10.1.fasta
	PopMap File:              /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/popmap.10.1
	Output file prefix:       test_A
	Path to R scripts and other scripts:        /work/hobi/jselwyn/Coryphopterus_RAD/scripts/fltrVCF/scripts
	HWE Script:               /work/hobi/jselwyn/Coryphopterus_RAD/scripts/fltrVCF/filter_hwe_by_pop_HPC.pl
	Rad_Haplotyper script:    /work/hobi/jselwyn/Coryphopterus_RAD/scripts/rad_haplotyper/rad_haplotyper.pl
	Number of threads:          20

Wed Sep 22 16:05:53 CDT 2021 Reading options from config file and setting defaults
	SETTINGS are being loaded from file: '/work/hobi/jselwyn/Coryphopterus_RAD/config_files/fltrVCF_A.config'
	Filters are set to '01 02 03 04 14 07 05 16 17 15 06 09 08 10 13 05 16 07 041 32 18 21'
	CutoffCode is set to '.10.1'
	BAM_PATH is set to '/work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test'
	SCRIPT_PATH is set to '/work/hobi/jselwyn/Coryphopterus_RAD/scripts/fltrVCF/scripts'
	VCF_FILE is set to '/work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/TotalRawSNPs.10.1.vcf'
	Bed file is set to '/work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/mapped.10.1.bed'
	Reference genome is set to '/work/hobi/jselwyn/Coryphopterus_RAD/mkREF_MiSeq/reference.10.1.fasta'
	PopMap is set to '/work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/popmap.10.1'
	HWE_SCRIPT is set to '/work/hobi/jselwyn/Coryphopterus_RAD/scripts/fltrVCF/filter_hwe_by_pop_HPC.pl'
	RADHAP_SCRIPT is set to '/work/hobi/jselwyn/Coryphopterus_RAD/scripts/rad_haplotyper/rad_haplotyper.pl'
	Output file prefix is set to 'test_A'
	The number of threads is set to '1'
	-P not set by user. Only filters that natively support parallelization will be run in parallel.
	/work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/TotalRawSNPs.10.1.vcf will be used for serial processing.

Wed Sep 22 16:05:53 CDT 2021 Getting universal chromosome/contig prefix ...
          Querying /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/TotalRawSNPs.10.1.vcf ...
          Prefix: dDocent
          It is assumed that all values in the CHROM column of vcf begin with dDocent
          If this is not the case, then fltrVCF will not work properly.
          The prefix is used to count SNPs/variants, contigs, etc and is used in some filters.

Wed Sep 22 16:05:53 CDT 2021  reading variables into MAIN

Wed Sep 22 16:05:54 CDT 2021 ---------------------------FILTER01: Remove sites with Y < alleles < X -----------------------------
     vcftools --vcf /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/TotalRawSNPs.10.1.vcf --min-alleles 2 --max-alleles 2 --recode --recode-INFO-all --out test_A.10.1.Fltr01.1.recode.vcf 2> /dev/null
	Sites remaining:	179502
	Contigs remaining:	15683


Wed Sep 22 16:06:10 CDT 2021 ---------------------------FILTER02: Remove Sites with Indels -----------------------------
     vcftools --vcf test_A.10.1.Fltr01.1.recode.vcf --remove-indels --recode --recode-INFO-all --out test_A.10.1.Fltr02.2.recode.vcf 2> /dev/null
	Sites remaining:	161192
	Contigs remaining:	15527


Wed Sep 22 16:06:25 CDT 2021 ---------------------------FILTER03: Remove Sites with QUAL < minQ -----------------------------
                                                                                                                        
                                                     Histogram of QUAL before FILTER03                                  
                                                                                                                        
                 1000 +---------------------------------------------------------------------------------------------+   
                      |                  +                  +                 +                  +            * *   |   
                  900 |-+                                       'QUALbefore' using (bin($1,binwidth)):(1.0)********-|   
                      |                                                                                    **** ****|   
                      |                                                                                ****** * * * |   
                  800 |-+                                                                            *** * ** * * *-|   
                      |                                                                              * * * ** * * * |   
                  700 |-+                                                                          *** * * ** * * *-|   
                      |                                                                          *** * * * ** * * * |   
                  600 |-+                                                                      *** * * * * ** * * *-|   
                      |                                                                     **** * * * * * ** * * * |   
                  500 |-+                                                                   ** * * * * * * ** * * *-|   
                      |                                                                 *** ** * * * * * * ** * * * |   
                      |                                                                 * **** * * * * * * ** * * * |   
                  400 |-+                                                             *** * ** * * * * * * ** * * *-|   
                      |                                                               * * * ** * * * * * * ** * * * |   
                  300 |-+                                                         ***** * * ** * * * * * * ** * * *-|   
                      |                                                           * * * * * ** * * * * * * ** * * * |   
                  200 |-+                                                         * * * * * ** * * * * * * ** * * *-|   
                      |                                                         *** * * * * ** * * * * * * ** * * * |   
                      |                                                       *** * * * * * ** * * * * * * ** * * * |   
                  100 |-+                                                    ** * * * * * * ** * * * * * * ** * * *-|   
                      |                  +                  +      ************ * * * * * * ** * * * * * * ** * * * |   
                    0 +---------------------------------------------------------------------------------------------+   
                      0                 100                200               300                400                500  
                                          QUAL ~ Phred-Scaled Probality of Zero Alternate Alleles                       
                                                                                                                        
                                                                                                                        
                                                                         Scatter plot of QUAL per site.                 
                                                                                                                        
                                                         500 +------------------------------------------------------+   
                                                             |     +     +     +     +      +     +     +  *  +     |   
                                                             |                                 'QUALbefore'**  *    |   
                                                             |                                              *       |   
                                                             |                                              **      |   
                                                         400 |-+                                             *    +-|   
                                                             |                                               **     |   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                         300 |-+                                              *   +-|   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                         200 |-+                                              *   +-|   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                         100 |-+                                              *   +-|   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                             |                                                *     |   
                                                             |     +     +     +     +      +     +     +     *     |   
                                                           0 +------------------------------------------------------+   
                                                             0   20000 40000 60000 80000  10000 12000 14000 16000 180000
                                                                                      Site                              
                                                                                                                        
     vcftools --vcf test_A.10.1.Fltr02.2.recode.vcf --minQ 40 --recode --recode-INFO-all --out test_A.10.1.Fltr03.3.recode.vcf 2> /dev/null
	Sites remaining:	161181
	Contigs remaining:	15527


Wed Sep 22 16:06:42 CDT 2021 ---------------------------FILTER04: Remove Sites With Mean Depth of Coverage < min-meanDP -----------------------------
                                                                                                                        
                                             Histogram of mean depth per site before FILTER04                           
                                                                                                                        
                 3000 +---------------------------------------------------------------------------------------------+   
                      |   *           +              +               +               +              +               |   
                      |   *                            'sitedepthmeanbefore' using (bin($1,binwidth)):(1.0) ******* |   
                      |   **                                                                                        |   
                 2500 |-+****                                                                                     +-|   
                      |  *****                                                                                      |   
                      |  *****                                                                                      |   
                      |  ******                                                                                     |   
                 2000 |-+******                                                                                   +-|   
                      |  ******                                                                                     |   
                      |  *******                                                                                    |   
                 1500 |-*********                                                                                 +-|   
                      | *********                                                                                   |   
                      | **********                                                                                  |   
                      | **********                                                                                  |   
                 1000 |-************                                                                              +-|   
                      | ************                                                                                |   
                      | **************                                                                              |   
                      | ***************                                                                             |   
                  500 |-*****************                                                                         +-|   
                      | ******************                                                                          |   
                      | **********************                                                                      |   
                      |******************************+               +               +              +               |   
                    0 +---------------------------------------------------------------------------------------------+   
                      0              100            200             300             400            500             600  
                                                                Mean Depth                                              
                                                                                                                        
                                                                                                                        
                                        Scatter plot of mean depth per site before FILTER04.                            
                                                                                                                        
            600 +---------------------------------------------------------------------------------------------------+   
                |          +          +          +          +           +          +          +          +          |   
                |                                                                     'sitedepthmeanbefore'    *    |   
                |                                                                                                   |   
            500 |-+                                                                                               +-|   
                |                                                                                                   |   
                |                                                                                                   |   
                |                                                                                                   |   
            400 |-+                                                                                               +-|   
                |                                                                                                   |   
                |                                                                                                   |   
            300 |-+                                                                                               +-|   
                |                                                                                                   |   
                |*                                                                                                  |   
                |*                                                                                                  |   
            200 |**                                                                                               +-|   
                | **                                                                                                |   
                |  ***                                                                                              |   
                |    *****                                                                                          |   
            100 |-+      ********                                                                                 +-|   
                |               ***************                                                                     |   
                |                             ***************************                                           |   
                |          +          +          +          +           *********************************+          |   
              0 +---------------------------------------------------------------------------------------------------+   
                0        20000      40000      60000      80000       100000     120000     140000     160000     180000
                                                                Site                                                    
                                                                                                                        
                                                                                                                        
                                    Scatter plot of depth variance vs mean depth per site before FILTER04.              
                                                                                                                        
                   300000 +-----------------------------------------------------------------------------------------+   
                          |              +              +              +              +              +       *      |   
                          |                                                           'meandepthVSvariance'    *    |   
                          |                                                                                         |   
                   250000 |-+                                                                                     +-|   
                          |                                                                                         |   
                          |                                                                                         |   
                          |                                                                                         |   
                   200000 |-+                                                                *                 *  +-|   
                          |                                       *                           *             **   *  |   
                          |                                                         **     *                        |   
                   150000 |-+                                                                 *            *      +-|   
                          |                                                      *                    * *           |   
                          |                                                               *       * * *     *       |   
                          |                                                 **                          * **        |   
                   100000 |-+                                            *      **   *      *   *** *             +-|   
                          |                            ****            *   **  *   *      *   ****  *               |   
                          |                          *****       **   ********* **   ***** ** ** **  **             |   
                          |                      *** ******** ****************** ******   **                        |   
                    50000 |-+             ** * ** **** ******************************** * *       *           * * +-|   
                          |             ******************************************* **  *                           |   
                          |         ******************************************* *  **    **                         |   
                          |     ****************************************  *         **+              +              |   
                        0 +-----------------------------------------------------------------------------------------+   
                          0             100            200            300            400            500            600  
                                                                  Mean Depth                                            
                                                                                                                        
     vcftools --vcf test_A.10.1.Fltr03.3.recode.vcf --min-meanDP 10 --recode --recode-INFO-all --out test_A.10.1.Fltr04.4.recode.vcf 2> /dev/null
	Sites remaining:	154204
	Contigs remaining:	14988


Wed Sep 22 16:07:01 CDT 2021 ---------------------------FILTER14: If individual's genotype has DP < X, convert to missing data -----------------------------
                                                                                                                        
                                                   Histogram of genotype depth before FILTER14                          
                                                                                                                        
                     300000 +---------------------------------------------------------------------------------------+   
                            |                 +                +                 +                +                 |   
                            |****                      'genotypedepthbefore' using (bin($1,binwidth)):(1.0) ******* |   
                            |   *                                                                                   |   
                     250000 |-+ *                                                                                 +-|   
                            |   *                                                                                   |   
                            |   *                                                                                   |   
                            |   *                                                                                   |   
                     200000 |-+ *                                                                                 +-|   
                            |   *                                                                                   |   
                            |   *                                                                                   |   
                     150000 |-+ *                                                                                 +-|   
                            |   *                                                                                   |   
                            |   *                                                                                   |   
                            |   *                                                                                   |   
                     100000 |-+ *                                                                                 +-|   
                            |   *                                                                                   |   
                            |   *                                                                                   |   
                            |   **********                                                                          |   
                      50000 |-+ *    *   **********                                                               +-|   
                            |   *    *   *    *   *******************                                               |   
                            |   *    *   *    *   *   *    *   *    ***************************                     |   
                            |   *    *   *    *   *   *    *   *    *   *   *    *   *    *   **********************|   
                          0 +---------------------------------------------------------------------------------------+   
                            0                 20               40                60               80               100  
                                                                      Depth                                             
                                                                                                                        
                                                                                                                        
                                     Scatter plot of mean depth per site before FILTER14.                               
                                                                                                                        
       100 +--------------------------------------------------------------------------------------------------------+   
           |                **                +                 +                +                 +                |   
           |                 **                                                       'genotypedepthbefore'    *    |   
           |                  ***                                                                                   |   
           |                    **                                                                                  |   
        80 |-+                   **                                                                               +-|   
           |                      ***                                                                               |   
           |                        **                                                                              |   
           |                         ***                                                                            |   
        60 |-+                         ***                                                                        +-|   
           |                             ***                                                                        |   
           |                               ****                                                                     |   
           |                                  ***                                                                   |   
           |                                    ***                                                                 |   
        40 |-+                                    ****                                                            +-|   
           |                                         ****                                                           |   
           |                                            ****                                                        |   
           |                                               ****                                                     |   
        20 |-+                                                *****                                               +-|   
           |                                                      ****                                              |   
           |                                                         ******                                         |   
           |                                                              ******                                    |   
           |                 +                +                 +              *******             +                |   
         0 +--------------------------------------------------------------------------------------------------------+   
           0               200000           400000            600000           800000            1e+06           1.2e+06
                                                           Genotype                                                     
                                                                                                                        
     vcftools --vcf test_A.10.1.Fltr04.4.recode.vcf --minDP 10 --recode --recode-INFO-all --out test_A.10.1.Fltr14.5.recode.vcf 2> /dev/null | vcffixup -
	Sites remaining:	154204
	Contigs remaining:	14988


Wed Sep 22 16:07:45 CDT 2021 ---------------------------FILTER07: Remove sites with Alternate Allele Count <=X -----------------------------
     vcffixup test_A.10.1.Fltr14.5.recode.vcf | vcffilter -s -f "AC > 0 & AN - AC > 0"  > test_A.10.1.Fltr07.6.vcf
	Sites remaining:	154097
	Contigs remaining:	14986

Wed Sep 22 16:08:19 CDT 2021 ---------------------------FILTER05: Remove sites called in <X proportion of individuals -----------------------------
                                                                                                                        
                                         Histogram of the proportion of genotypes that are missing                      
                                                                                                                        
                 40000 +--------------------------------------------------------------------------------------------+   
                       |                  +                 +                  +                 +                  |   
                       |                  ***************  'sitemissingness' using (bin($1,binwidth)):(1.0) ******* |   
                 35000 |-+                *             *                                                         +-|   
                       |                  *             *                                                           |   
                       |                  *             *                                                           |   
                 30000 |-+                *             *                                                         +-|   
                       |*******************             *                                                           |   
                       |      *           *             ***************                                             |   
                 25000 |-+    *           *             *             *                                           +-|   
                       |      *           *             *             *                                             |   
                 20000 |-+    *           *             *             **************                              +-|   
                       |      *           *             *             *            *                                |   
                       |      *           *             *             *            *                                |   
                 15000 |-+    *           *             *             *            ***************                +-|   
                       |      *           *             *             *            *             *                  |   
                       |      *           *             *             *            *             *                  |   
                 10000 |-+    *           *             *             *            *             *                +-|   
                       |      *           *             *             *            *             *                  |   
                       |      *           *             *             *            *             *                  |   
                  5000 |-+    *           *             *             *            *             *                +-|   
                       |      *           *             *             *            *             *                  |   
                       |      *           *             *   +         *        +   *             ********           |   
                     0 +--------------------------------------------------------------------------------------------+   
                       0                 0.2               0.4                0.6               0.8                 1   
                                                            Proportion Missing                                          
                                                                                                                        
                                                                                                                        
                                             Scatter plot of the proportion of genotypes that are missing.              
                                                                                                                        
                              0.9 +---------------------------------------------------------------------------------+   
                                  |*        +          +         +         +         +          +         +         |   
                                  |                                                       'sitemissingness'    *    |   
                              0.8 |-+                                                                             +-|   
                                  |                                                                                 |   
                              0.7 |*********                                                                      +-|   
                                  |                                                                                 |   
                                  |                                                                                 |   
                              0.6 |-+      ***********                                                            +-|   
                                  |                                                                                 |   
                              0.5 |-+                                                                             +-|   
                                  |                                                                                 |   
                                  |                  **************                                                 |   
                              0.4 |-+                                                                             +-|   
                                  |                                                                                 |   
                              0.3 |-+                                                                             +-|   
                                  |                               ********************                              |   
                                  |                                                                                 |   
                              0.2 |-+                                                                             +-|   
                                  |                                                  ***************                |   
                              0.1 |-+                                                                             +-|   
                                  |                                                                                 |   
                                  |         +          +         +         +         +          +         +         |   
                                0 +---------------------------------------------------------------------------------+   
                                  0       20000      40000     60000     80000     100000     120000    140000    160000
                                                                         Site                                           
                                                                                                                        
     vcftools --vcf test_A.10.1.Fltr07.6.vcf --max-missing 0.5 --recode --recode-INFO-all --out test_A.10.1.Fltr05.7.recode.vcf 2> /dev/null
	Sites remaining:	116966
	Contigs remaining:	10932


Wed Sep 22 16:08:34 CDT 2021 ---------------------------FILTER16: Remove Individuals|Libraries with Too Much Missing Data-----------------------------
                                                                                                                        
                      Histogram of % missing data per individual|library before filter. Bars to the left are desireable.
                                                                                                                        
                                   2 +------------------------------------------------------------------------------+   
                                     |   * * *       +               +              +               +               |   
                                     |   * * *                'totalmissing' using (bin($1,binwidth)):(1.0) ******* |   
                                     |   * * *                                                                      |   
                                     |   * * *                                                                      |   
                                     |   * * *                                                                      |   
                                 1.5 |-+ * * *                                                                    +-|   
                                     |   * * *                                                                      |   
                                     |   * * *                                                                      |   
                                     |   * * *                                                                      |   
                                     |   * * *                                                                      |   
                                   1 |-+ * * ******************************************                           +-|   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                 0.5 |-+ * * *              *                   *     *                           +-|   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *              *                   *     *                             |   
                                     |   * * *       +      *        +          *   + *             +               |   
                                   0 +------------------------------------------------------------------------------+   
                                     0              0.2             0.4            0.6             0.8              1   
                                                                   % missing genotypes                                  
                                                                                                                        
                                                                                                                        
                                          Scatter plot of % missing data per individual|library.                        
                                                                                                                        
                     1 +--------------------------------------------------------------------------------------------+   
                       |           +          +           +           +          +           +          +           |   
                       |                                                                        'imiss.dat'    *    |   
                       |                                                                                            |   
                       |                                                                                            |   
                   0.8 |-+                                                                                        +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                                                                            |   
                   0.6 |-+         *                                                                              +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                      *                                                                     |   
                       |                                                                                            |   
                   0.4 |-+                                                                                        +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                                                                            |   
                   0.2 |-+                                                                                        +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                  *           *          *           *                      |   
                       |           +          +           +           +          +           +          *           |   
                     0 +--------------------------------------------------------------------------------------------+   
                       0           1          2           3           4          5           6          7           8   
                                                                Individual                                              
                                                                                                                        
 0 individuals|libraries with too much missing data:
INDV
     vcftools --vcf test_A.10.1.Fltr05.7.recode.vcf --remove test_A.10.1.Fltr16.8.lowDP-2.indv --recode --recode-INFO-all --out test_A.10.1.Fltr16.8.recode.vcf 2> /dev/null | vcffixup -
	Sites remaining:	116966
	Contigs remaining:	10932


 Individuals|Libraries Remaining Per Sample
      7 COPE

Wed Sep 22 16:09:05 CDT 2021 ---------------------------FILTER17: Remove sites with data missing for too many individuals|libraries in a population -----------------------------
     Using PopMap File: /work/hobi/jselwyn/Coryphopterus_RAD/mkVCF_test/popmap.10.1
     vcftools --vcf test_A.10.1.Fltr16.8.recode.vcf --exclude-positions test_A.10.1.Fltr17.9.badloci --recode --recode-INFO-all --out test_A.10.1.Fltr17.9.recode.vcf 2> /dev/null
	Sites remaining:	116966
	Contigs remaining:	10932


Wed Sep 22 16:09:18 CDT 2021 ---------------------------FILTER15: Remove sites with maf > minor allele frequency > max-maf -----------------------------
     vcftools --vcf test_A.10.1.Fltr17.9.recode.vcf --maf 0 --max-maf 1 --recode --recode-INFO-all --out test_A.10.1.Fltr15.10.recode.vcf 2> /dev/null
	Sites remaining:	116966
	Contigs remaining:	10932


Wed Sep 22 16:09:30 CDT 2021 ---------------------------FILTER06: Remove sites with Average Allele Balance deviating too far from 0.5 while keeping those with AB=0  -----------------------------
                                                                                                                        
                                                        Histogram of Allele Balance                                     
                                                                                                                        
                 25000 +--------------------------------------------------------------------------------------------+   
                       |                  +                 +                  +                 +                  |   
                       |                                        'siteAB.dat' using (bin($1,binwidth)):(1.0) ******* |   
                       |***                                                                                         |   
                       |  *                                                                                         |   
                 20000 |-+*                                                                                       +-|   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                 15000 |-+*                                                                                       +-|   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                 10000 |-+*                                                                                       +-|   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                       |  *                                                                                         |   
                  5000 |-+*                                                                                       +-|   
                       |  *                                           *                                             |   
                       |  *                                 ***************                                         |   
                       |  *                               ***********************                                   |   
                       |  *               +        ***************************************** **  +                  |   
                     0 +--------------------------------------------------------------------------------------------+   
                       0                 0.2               0.4                0.6               0.8                 1   
                         Allele Balance ~ proportion of alleles in heterozygotes that are reference allelic state       
                                                                                                                        
                                                                                                                        
                                                     Scatter plot of Allele Balance.                                    
                                                                                                                        
                  1 +-----------------------------------------------------------------------------------------------+   
                    |               +               +               +               +               +               |   
                0.9 |*+                                                                        'siteAB.dat'    *  +-|   
                    |**                                                                                             |   
                    | **                                                                                            |   
                0.8 |-+***                                                                                        +-|   
                    |    **                                                                                         |   
                0.7 |-+   ****                                                                                    +-|   
                    |        *****                                                                                  |   
                0.6 |-+          ******                                                                           +-|   
                    |                 **********                                                                    |   
                0.5 |-+                        *************                                                      +-|   
                    |                                      ************                                             |   
                    |                                                 ***********                                   |   
                0.4 |-+                                                         ********                          +-|   
                    |                                                                  ****                         |   
                0.3 |-+                                                                   ***                     +-|   
                    |                                                                       **                      |   
                0.2 |-+                                                                      **                   +-|   
                    |                                                                         **                    |   
                    |                                                                          **                   |   
                0.1 |-+                                                                         *                 +-|   
                    |               +               +               +               +           *   +               |   
                  0 +-----------------------------------------------------------------------------------------------+   
                    0             20000           40000           60000           80000           100000          120000
                                                                  Site                                                  
                                                                                                                        
     vcffixup test_A.10.1.Fltr15.10.recode.vcf | vcffilter -s -f "AB > 0.375 & AB < 0.625 | AB = 0"  > test_A.10.1.Fltr06.11.vcf
	Sites remaining:	88372
	Contigs remaining:	10380

Wed Sep 22 16:10:02 CDT 2021 ---------------------------FILTER09: Remove sites with low/high ratio of mean mapping quality of alt to ref -----------------------------
     vcffilter -s -f "MQM / MQMR > 0.75 & MQM / MQMR < 1.33333" test_A.10.1.Fltr06.11.vcf > test_A.10.1.Fltr09.12.vcf
	Sites remaining:	87410
	Contigs remaining:	10353

Wed Sep 22 16:10:11 CDT 2021 ---------------------------FILTER08: Remove sites covered by both F and R reads-----------------------------
     vcffilter -s -f "SAF / SAR > 10 & SRF / SRR > 10 | SAR / SAF > 10 & SRR / SRF > 10" test_A.10.1.Fltr09.12.vcf > test_A.10.1.Fltr08.13.vcf
	Sites remaining:	63702
	Contigs remaining:	8800

Wed Sep 22 16:10:20 CDT 2021 ---------------------------FILTER10: Remove sites with one allele only supported by reads not properly paired -----------------------------
     vcffilter -s -f "PAIRED > 0.05 & PAIREDR > 0.05 & PAIREDR / PAIRED < 1.75 & PAIREDR / PAIRED > 0.25 | PAIRED < 0.05 & PAIREDR < 0.05" test_A.10.1.Fltr08.13.vcf > test_A.10.1.Fltr10.14.vcf
	Sites remaining:	62477
	Contigs remaining:	8600

Wed Sep 22 16:10:27 CDT 2021 ---------------------------FILTER13: Remove sites with mean DP greater than X  -----------------------------
                                                                                                                        
                                                 Histogram of mean depth per site before filter                         
                                                                                                                        
                       1200 +---------------------------------------------------------------------------------------+   
                            |         +         +        +         +         +         +        +         +         |   
                            |    **                 'meandepthpersitebefore' using (bin($1,binwidth)):(1.0) ******* |   
                            |    ***                                                                                |   
                       1000 |-+  ****                                                                             +-|   
                            |    ****                                                                               |   
                            |   *****                                                                               |   
                            |   *******                                                                             |   
                        800 |-+ ********                                                                          +-|   
                            |  **********                                                                           |   
                            |  **********                                                                           |   
                        600 |-+***********                                                                        +-|   
                            |  ***********                                                                          |   
                            |  ************                                                                         |   
                            |  *************                                                                        |   
                        400 |-+**************                                                                     +-|   
                            |  ************** *                                                                     |   
                            | ****************** *                                                                  |   
                            | ********************                                                                  |   
                        200 |-**********************                                                              +-|   
                            | ***********************                                                               |   
                            | ****************************                                                          |   
                            | ***********************************  +         +         +        +         +         |   
                          0 +---------------------------------------------------------------------------------------+   
                            0         50       100      150       200       250       300      350       400       450  
                                                                   Mean Depth                                           
                                                                                                                        
     vcftools --vcf test_A.10.1.Fltr10.14.vcf --max-meanDP 250 --recode --recode-INFO-all --out test_A.10.1.Fltr13.15.recode.vcf 2> /dev/null
	Sites remaining:	62421
	Contigs remaining:	8589


Wed Sep 22 16:10:35 CDT 2021 ---------------------------FILTER05: Remove sites called in <X proportion of individuals -----------------------------
                                                                                                                        
                                         Histogram of the proportion of genotypes that are missing                      
                                                                                                                        
                 25000 +--------------------------------------------------------------------------------------------+   
                       |                  +                 +                  +                 +                  |   
                       |                                   'sitemissingness' using (bin($1,binwidth)):(1.0) ******* |   
                       |                  ***************                                                           |   
                       |                  *             *                                                           |   
                 20000 |-+                *             *                                                         +-|   
                       |                  *             *                                                           |   
                       |                  *             *                                                           |   
                       |                  *             *                                                           |   
                 15000 |-+    *************             *                                                         +-|   
                       |      *           *             *                                                           |   
                       |*******           *             ********                                                    |   
                       |      *           *             *      *                                                    |   
                       |      *           *             *      *                                                    |   
                 10000 |-+    *           *             *      *                                                  +-|   
                       |      *           *             *      *                                                    |   
                       |      *           *             *      *                                                    |   
                       |      *           *             *      *                                                    |   
                  5000 |-+    *           *             *      *                                                  +-|   
                       |      *           *             *      *                                                    |   
                       |      *           *             *      *                                                    |   
                       |      *           *             *      *                                                    |   
                       |      *           *             *   +  *               +                 +                  |   
                     0 +--------------------------------------------------------------------------------------------+   
                       0                 0.2               0.4                0.6               0.8                 1   
                                                            Proportion Missing                                          
                                                                                                                        
                                                                                                                        
                                             Scatter plot of the proportion of genotypes that are missing.              
                                                                                                                        
                              0.45 +--------------------------------------------------------------------------------+   
                                   |***************       +           +          +           +          +           |   
                                   |                                                      'sitemissingness'    *    |   
                               0.4 |-+                                                                            +-|   
                                   |                                                                                |   
                              0.35 |-+                                                                            +-|   
                                   |                                                                                |   
                                   |                                                                                |   
                               0.3 |-+            **************************                                      +-|   
                                   |                                                                                |   
                              0.25 |-+                                                                            +-|   
                                   |                                                                                |   
                                   |                                                                                |   
                               0.2 |-+                                                                            +-|   
                                   |                                                                                |   
                              0.15 |-+                                                                            +-|   
                                   |                                       ******************                       |   
                                   |                                                                                |   
                               0.1 |-+                                                                            +-|   
                                   |                                                                                |   
                              0.05 |-+                                                                            +-|   
                                   |                                                                                |   
                                   |           +          +           +          +           +          +           |   
                                 0 +--------------------------------------------------------------------------------+   
                                   0         10000      20000       30000      40000       50000      60000       70000 
                                                                         Site                                           
                                                                                                                        
     vcftools --vcf test_A.10.1.Fltr13.15.recode.vcf --max-missing 0.7 --recode --recode-INFO-all --out test_A.10.1.Fltr05.16.recode.vcf 2> /dev/null
	Sites remaining:	49222
	Contigs remaining:	6707


Wed Sep 22 16:10:41 CDT 2021 ---------------------------FILTER16: Remove Individuals|Libraries with Too Much Missing Data-----------------------------
                                                                                                                        
                      Histogram of % missing data per individual|library before filter. Bars to the left are desireable.
                                                                                                                        
                                   3 +------------------------------------------------------------------------------+   
                                     | *             + *             +              +               +               |   
                                     | *               *      'totalmissing' using (bin($1,binwidth)):(1.0) ******* |   
                                     | *               *                                                            |   
                                 2.5 |-*               *                                                          +-|   
                                     | *               *                                                            |   
                                     | *               *                                                            |   
                                     | *               *                                                            |   
                                   2 |**               *                                                          +-|   
                                     | *               *                                                            |   
                                     | *               *                                                            |   
                                 1.5 |-*               *                                                          +-|   
                                     | *               *                                                            |   
                                     | *               *                                                            |   
                                     | *               *                                                            |   
                                   1 |-*               *******************************                            +-|   
                                     | *               *                      *      *                              |   
                                     | *               *                      *      *                              |   
                                     | *               *                      *      *                              |   
                                 0.5 |-*               *                      *      *                            +-|   
                                     | *               *                      *      *                              |   
                                     | *               *                      *      *                              |   
                                     | *             + *             +        *     +*              +               |   
                                   0 +------------------------------------------------------------------------------+   
                                     0              0.2             0.4            0.6             0.8              1   
                                                                   % missing genotypes                                  
                                                                                                                        
                                                                                                                        
                                          Scatter plot of % missing data per individual|library.                        
                                                                                                                        
                     1 +--------------------------------------------------------------------------------------------+   
                       |           +          +           +           +          +           +          +           |   
                       |                                                                        'imiss.dat'    *    |   
                       |                                                                                            |   
                       |                                                                                            |   
                   0.8 |-+                                                                                        +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                                                                            |   
                   0.6 |-+         *                                                                              +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                      *                                                                     |   
                   0.4 |-+                                                                                        +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                                                                            |   
                   0.2 |-+                                                                                        +-|   
                       |                                                                                            |   
                       |                                                                                            |   
                       |                                                                                            |   
                       |           +          +           *           *          *           +          +           |   
                     0 +--------------------------------------------------------------------------------------------+   
                       0           1          2           3           4          5           6          7           8   
                                                                Individual                                              
                                                                                                                        
 2 individuals|libraries with too much missing data:
INDV
COPE_0773.fp2.repr
COPE_0922.fp2.repr
     vcftools --vcf test_A.10.1.Fltr05.16.recode.vcf --remove test_A.10.1.Fltr16.17.lowDP-2.indv --recode --recode-INFO-all --out test_A.10.1.Fltr16.17.recode.vcf 2> /dev/null | vcffixup -
	Sites remaining:	49222
	Contigs remaining:	6707


 Individuals|Libraries Remaining Per Sample
      5 COPE

Wed Sep 22 16:10:53 CDT 2021 ---------------------------FILTER07: Remove sites with Alternate Allele Count <=X -----------------------------
     vcffixup test_A.10.1.Fltr16.17.recode.vcf | vcffilter -s -f "AC > 0 & AN - AC > 0"  > test_A.10.1.Fltr07.18.vcf
	Sites remaining:	48042
	Contigs remaining:	6681

Wed Sep 22 16:11:03 CDT 2021 ---------------------------FILTER041: Remove Contigs With Extreme DP -----------------------------
── Attaching packages ────────────────────────────────── tidyverse 1.3.0.9000 ──
✔ ggplot2 3.3.5     ✔ purrr   0.3.4
✔ tibble  3.1.4     ✔ dplyr   1.0.7
✔ tidyr   1.1.3     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

Attaching package: ‘gridExtra’

The following object is masked from ‘package:dplyr’:

    combine

'data.frame':	6681 obs. of  6 variables:
 $ Contig       : Factor w/ 6681 levels "dDocent_Contig_100",..: 1356 4348 6389 328 4569 3293 5734 4551 6433 4906 ...
 $ BP           : int  2 1 4 1 2 2 2 1 3 3 ...
 $ Mean_Mean_Cvg: num  8.4 10.8 11.9 12 12 ...
 $ CV_Mean_Cvg  : num  0 0 0.000525 0 0 ...
 $ Mean_CV_Cvg  : num  0.434 0.367 0.578 0.543 0.377 ...
 $ CV_CV_Cvg    : num  0 0 0.00581 0 0 ...
Error in quantile.default(df$CV_Mean_Cvg, probs = c(lowPCT_Mean_CV_Cvg,  : 
  missing values and NaN's not allowed if 'na.rm' is FALSE
Calls: quantile -> quantile.default
Execution halted
 The following contigs have been filtered:
	dDocent_Contig_10041	dDocent_Contig_1024	dDocent_Contig_10887	dDocent_Contig_11685	dDocent_Contig_12044
	dDocent_Contig_12191	dDocent_Contig_1251	dDocent_Contig_13382	dDocent_Contig_1347	dDocent_Contig_13492
	dDocent_Contig_14274	dDocent_Contig_15240	dDocent_Contig_15548	dDocent_Contig_15559	dDocent_Contig_15658
	dDocent_Contig_1589	dDocent_Contig_16108	dDocent_Contig_1650	dDocent_Contig_16561	dDocent_Contig_171
	dDocent_Contig_172	dDocent_Contig_1722	dDocent_Contig_17527	dDocent_Contig_1787	dDocent_Contig_180
	dDocent_Contig_1811	dDocent_Contig_19288	dDocent_Contig_19747	dDocent_Contig_1976	dDocent_Contig_2033
	dDocent_Contig_20489	dDocent_Contig_20737	dDocent_Contig_2145	dDocent_Contig_21839	dDocent_Contig_22018
	dDocent_Contig_2372	dDocent_Contig_23823	dDocent_Contig_24693	dDocent_Contig_24878	dDocent_Contig_24993
	dDocent_Contig_25262	dDocent_Contig_25542	dDocent_Contig_25837	dDocent_Contig_25890	dDocent_Contig_26042
	dDocent_Contig_26262	dDocent_Contig_27379	dDocent_Contig_2760	dDocent_Contig_2813	dDocent_Contig_28249
	dDocent_Contig_2833	dDocent_Contig_28473	dDocent_Contig_290	dDocent_Contig_29217	dDocent_Contig_2956
	dDocent_Contig_29872	dDocent_Contig_3166	dDocent_Contig_31740	dDocent_Contig_32421	dDocent_Contig_325
	dDocent_Contig_32592	dDocent_Contig_33836	dDocent_Contig_34537	dDocent_Contig_3456	dDocent_Contig_34587
	dDocent_Contig_34637	dDocent_Contig_35403	dDocent_Contig_35717	dDocent_Contig_3656	dDocent_Contig_36883
	dDocent_Contig_37068	dDocent_Contig_374	dDocent_Contig_379	dDocent_Contig_37945	dDocent_Contig_39266
	dDocent_Contig_39403	dDocent_Contig_39432	dDocent_Contig_3960	dDocent_Contig_40189	dDocent_Contig_40564
	dDocent_Contig_41343	dDocent_Contig_415	dDocent_Contig_4207	dDocent_Contig_42738	dDocent_Contig_43030
	dDocent_Contig_4304	dDocent_Contig_43258	dDocent_Contig_44179	dDocent_Contig_44579	dDocent_Contig_44635
	dDocent_Contig_45297	dDocent_Contig_46023	dDocent_Contig_46415	dDocent_Contig_46730	dDocent_Contig_47209
	dDocent_Contig_47218	dDocent_Contig_48225	dDocent_Contig_48471	dDocent_Contig_49560	dDocent_Contig_49837
	dDocent_Contig_50649	dDocent_Contig_50651	dDocent_Contig_50809	dDocent_Contig_51202	dDocent_Contig_5228
	dDocent_Contig_52442	dDocent_Contig_52503	dDocent_Contig_54324	dDocent_Contig_55475	dDocent_Contig_56133
	dDocent_Contig_5669	dDocent_Contig_57433	dDocent_Contig_577	dDocent_Contig_5933	dDocent_Contig_59459
	dDocent_Contig_60235	dDocent_Contig_6095	dDocent_Contig_61566	dDocent_Contig_6175	dDocent_Contig_628
	dDocent_Contig_63664	dDocent_Contig_63999	dDocent_Contig_64498	dDocent_Contig_65362	dDocent_Contig_65773
	dDocent_Contig_67153	dDocent_Contig_67385	dDocent_Contig_67639	dDocent_Contig_67753	dDocent_Contig_6819
	dDocent_Contig_6821	dDocent_Contig_68274	dDocent_Contig_69000	dDocent_Contig_695	dDocent_Contig_70543
	dDocent_Contig_70931	dDocent_Contig_71429	dDocent_Contig_71595	dDocent_Contig_71722	dDocent_Contig_72028
	dDocent_Contig_72088	dDocent_Contig_72602	dDocent_Contig_72974	dDocent_Contig_73092	dDocent_Contig_7547
	dDocent_Contig_75509	dDocent_Contig_75949	dDocent_Contig_7607	dDocent_Contig_76072	dDocent_Contig_76375
	dDocent_Contig_77462	dDocent_Contig_77916	dDocent_Contig_78088	dDocent_Contig_782	dDocent_Contig_78326
	dDocent_Contig_78848	dDocent_Contig_7938	dDocent_Contig_79551	dDocent_Contig_80098	dDocent_Contig_8036
	dDocent_Contig_8057	dDocent_Contig_81317	dDocent_Contig_82429	dDocent_Contig_82569	dDocent_Contig_82908
	dDocent_Contig_82934	dDocent_Contig_83061	dDocent_Contig_832	dDocent_Contig_839	dDocent_Contig_85459
	dDocent_Contig_85982	dDocent_Contig_86869	dDocent_Contig_87045	dDocent_Contig_87600	dDocent_Contig_87784
	dDocent_Contig_88151	dDocent_Contig_88216	dDocent_Contig_8845	dDocent_Contig_88548	dDocent_Contig_89516
	dDocent_Contig_89970	dDocent_Contig_90166	dDocent_Contig_90441	dDocent_Contig_90812	dDocent_Contig_91593
	dDocent_Contig_91730	dDocent_Contig_91731	dDocent_Contig_91989	dDocent_Contig_931	dDocent_Contig_93393
	dDocent_Contig_93448	dDocent_Contig_94052	dDocent_Contig_95078	dDocent_Contig_95737	dDocent_Contig_96151
	dDocent_Contig_96192	dDocent_Contig_962	dDocent_Contig_96993	dDocent_Contig_9771	dDocent_Contig_978
	dDocent_Contig_996

 Plots output to test_A.10.1.Fltr041.19.ldepth.mean.contigs.pdf

Wed Sep 22 16:11:07 CDT 2021 ---------------------------FILTER32: Keep Contigs w Fewer Heterozygotes -----------------------------
test_A.10.1.Fltr041.19.vcf
0.9
[1] TRUE TRUE
Saving 7 x 7 in image
── Attaching packages ────────────────────────────────── tidyverse 1.3.0.9000 ──
✔ ggplot2 3.3.5     ✔ purrr   0.3.4
✔ tibble  3.1.4     ✔ dplyr   1.0.7
✔ tidyr   1.1.3     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

Attaching package: ‘gridExtra’

The following object is masked from ‘package:dplyr’:

    combine

Warning messages:
1: Removed 2 rows containing missing values (geom_bar). 
2: Removed 2 rows containing missing values (geom_bar). 
null device 
          1 

 The following contigs have been filtered:
	dDocent_Contig_1001	dDocent_Contig_1419	dDocent_Contig_1665	dDocent_Contig_1991	dDocent_Contig_242
	dDocent_Contig_25440	dDocent_Contig_2829	dDocent_Contig_28710	dDocent_Contig_382	dDocent_Contig_4077
	dDocent_Contig_422	dDocent_Contig_458	dDocent_Contig_47193	dDocent_Contig_49750	dDocent_Contig_50766
	dDocent_Contig_5119	dDocent_Contig_52098	dDocent_Contig_52239	dDocent_Contig_54760	dDocent_Contig_5583
	dDocent_Contig_56542	dDocent_Contig_58512	dDocent_Contig_60478	dDocent_Contig_61450	dDocent_Contig_62433
	dDocent_Contig_7077	dDocent_Contig_86562	dDocent_Contig_877	dDocent_Contig_90908

 Plots output to test_A.10.1.Fltr32.20.hetero.contigs.plots.pdf

	Sites remaining:	46951
	Contigs remaining:	6451

Wed Sep 22 16:11:42 CDT 2021 ---------------------------FILTER18: Remove sites not in HWE p<X) -----------------------------
Processing population: COPE (7 inds)
Outputting results of HWE test for filtered loci to 'filtered.hwe'
Kept 46951 of a possible 46951 loci (filtered 0 loci)

	Sites remaining:	46951
	Contigs remaining:	6451
	Sites remaining:	46951
	Contigs remaining:	6451

Wed Sep 22 16:11:47 CDT 2021 ---------------------------FILTER21: Select Most Informative SNP per Contig -----------------------------
46950
46950
6451

Wed Sep 22 16:12:22 CDT 2021  --------------------------- Filtering complete! ---------------------------


Wed Sep 22 16:12:23 CDT 2021 Running fltrVCFstats2 with the following settings...
          DIRECTORY: /work/hobi/jselwyn/Coryphopterus_RAD/fltrVCF_test
          THREADS: 20
          FILE PREFIX: test_A

Wed Sep 22 16:12:23 CDT 2021 Getting universal chromosome/contig prefix ...
          Querying  ...
          Prefix: dDocent
          It is assumed that all values in the CHROM column of vcf begin with dDocent
          If this is not the case, then fltrVCF will not work properly.

Wed Sep 22 16:12:23 CDT 2021 Making column 1 of 19 ...

Wed Sep 22 16:12:23 CDT 2021 Making column 2 of 19 ...

Wed Sep 22 16:12:23 CDT 2021 Making column 3 of 19 ...

Wed Sep 22 16:12:23 CDT 2021 Making column 4 of 19 ...

Wed Sep 22 16:12:24 CDT 2021 Making column 5 of 19 ...

Wed Sep 22 16:12:25 CDT 2021 Making column 6 of 19 ...

Wed Sep 22 16:12:25 CDT 2021 Making column 7 of 19 ...

Wed Sep 22 16:12:26 CDT 2021 Making column 8 of 19 ...

Wed Sep 22 16:12:26 CDT 2021 Making column 9 of 19 ...

Wed Sep 22 16:12:26 CDT 2021 Making column 10 of 19 ...

Wed Sep 22 16:12:27 CDT 2021 Making column 11 of 19 ...

Wed Sep 22 16:12:27 CDT 2021 Making column 12 of 19 ...

Wed Sep 22 16:12:27 CDT 2021 Making column 13 of 19 ...

Wed Sep 22 16:12:29 CDT 2021 Making column 14 of 19 ...

Wed Sep 22 16:12:42 CDT 2021 Making column 15 of 19 ...

Wed Sep 22 16:12:52 CDT 2021 Making column 16 of 19 ...

Wed Sep 22 16:13:05 CDT 2021 Making column 17 of 19 ...

Wed Sep 22 16:13:18 CDT 2021 Making column 18 of 19 ...

Wed Sep 22 16:13:30 CDT 2021 Making column 19 of 19 ...

Wed Sep 22 16:13:40 CDT 2021 Assembling tidy data table...

Wed Sep 22 16:13:40 CDT 2021 Plotting results...
Warning messages:
1: Removed 22 row(s) containing missing values (geom_path). 
2: Removed 22 rows containing missing values (geom_point). 
null device 
          1 

Wed Sep 22 16:13:43 CDT 2021 fltrVCFstats2 complete!
